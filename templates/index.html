{% extends "base.html" %}

{% block title %}Yash's Weather App - Current Weather & 5-Day Forecast{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <!-- Current Weather Card -->
        <div id="weatherCard" class="card weather-card mb-4" style="display: none;">
            <div class="card-header">
                <h5 class="card-title mb-0">
                    <i class="fas fa-thermometer-half me-2"></i>
                    Current Weather
                </h5>
            </div>
            <div class="card-body">
                <div id="currentWeather">
                    <!-- Weather data will be populated by JavaScript -->
                </div>
            </div>
        </div>
        
        <!-- 5-Day Forecast Card -->
        <div id="forecastCard" class="card weather-card mb-4" style="display: none;">
            <div class="card-header">
                <h5 class="card-title mb-0">
                    <i class="fas fa-chart-line me-2"></i>
                    5-Day Forecast
                </h5>
            </div>
            <div class="card-body">
                <!-- Interactive Chart Instructions -->
                <div class="alert alert-info alert-dismissible fade show" role="alert">
                    <i class="fas fa-info-circle me-2"></i>
                    <strong>Interactive Chart:</strong> Hover over data points for details, or click any point to see more weather information.
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
                
                <!-- Temperature Chart -->
                <div class="chart-container mb-4">
                    <canvas id="temperatureChart" 
                            aria-label="Temperature forecast chart"
                            role="img">
                        <p>This chart shows the temperature forecast over time. If you cannot see the chart, please enable JavaScript or use a screen reader compatible browser.</p>
                    </canvas>
                </div>
                
                <!-- Forecast List -->
                <div class="row" id="forecastList">
                    <!-- Forecast items will be populated by JavaScript -->
                </div>
            </div>
        </div>
        
        <!-- Welcome Message -->
        <div id="welcomeMessage" class="text-center py-5">
            <div class="row justify-content-center">
                <div class="col-md-6">
                    <i class="fas fa-cloud-sun fa-4x text-primary mb-3"></i>
                    <h2 class="h4 mb-3">Welcome to Yash's Weather App</h2>
                    <p class="text-muted mb-4">
                        Get current weather conditions and 5-day forecasts for any city around the world.
                    </p>
                    <div class="d-grid gap-2 d-sm-flex justify-content-sm-center">
                        <button type="button" 
                                class="btn btn-primary btn-lg px-4"
                                onclick="document.getElementById('citySearch').focus()">
                            <i class="fas fa-search me-2"></i>
                            Search a City
                        </button>
                        <button type="button" 
                                class="btn btn-outline-primary btn-lg px-4"
                                onclick="app.getLocationWeather()">
                            <i class="fas fa-location-arrow me-2"></i>
                            Use My Location
                        </button>
                    </div>
                    
                    <div class="mt-4">
                        <h6 class="text-muted">Features:</h6>
                        <div class="row mt-3">
                            <div class="col-md-4 mb-3">
                                <i class="fas fa-map-marker-alt text-primary mb-2"></i>
                                <p class="small mb-0">Location-based weather</p>
                            </div>
                            <div class="col-md-4 mb-3">
                                <i class="fas fa-chart-line text-primary mb-2"></i>
                                <p class="small mb-0">Interactive charts</p>
                            </div>
                            <div class="col-md-4 mb-3">
                                <i class="fas fa-star text-primary mb-2"></i>
                                <p class="small mb-0">Favorite cities</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Hidden screen reader announcements -->
<div aria-live="polite" aria-atomic="true" class="sr-only" id="srAnnouncements"></div>

<script>
// Hide welcome message when weather data is displayed
document.addEventListener('DOMContentLoaded', function() {
    const observer = new MutationObserver(function(mutations) {
        mutations.forEach(function(mutation) {
            if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
                const weatherCard = document.getElementById('weatherCard');
                const welcomeMessage = document.getElementById('welcomeMessage');
                
                if (weatherCard.style.display !== 'none') {
                    welcomeMessage.style.display = 'none';
                } else {
                    welcomeMessage.style.display = 'block';
                }
            }
        });
    });
    
    observer.observe(document.getElementById('weatherCard'), {
        attributes: true,
        attributeFilter: ['style']
    });
});
</script>
{% endblock %}
